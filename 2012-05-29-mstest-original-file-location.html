<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MsTest Original File Location</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="How to find the original location of the dll when using MsTest.">
    <meta name="author" content="Mat Roberts">
    <link rel="canonical" href="https://moleseyhill.com/2012-05-29-mstest-original-file-location.html">
    <link href="styles/sanitize.css" rel="stylesheet">
    <link href="styles/prism.css" rel="stylesheet">
    <link href="styles/struggle.css" rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon" href='favicon.ico'>
    
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans" rel="stylesheet">
</head>

<body>
<header>
    <h1><a href="index.html">Struggling&nbsp;for Competence</a></h1>
    <nav>
<menu>
<li><a href="2011-12-05-lines-of-code.html">Previous</a></li>
<li><a href="2012-05-30-maximum-contiguous-sum.html">Next</a></li>
</menu>
</nav>
</header>

<article>
    <h2>MsTest Original File Location</h2>
    
    
<p>One of the "features" with MsTest is that it copies the build outputs to a deployment directory before running the tests.  This causes a problem in the unusual situation where your test needs to access the original source code tree - it's hard to work out where that code is in a reliable fashion.</p>

<p>After a lot of googling I finallly found a <a href="http://devnet.jetbrains.net/message/5232885">work around to this problem</a> posted by Mihai Danila.  It relies on the presence of debug information for the unit test assembly.</p>

<pre>
<code class="language-csharp">
string theFolderWhereThisSourceFileIs = Path.GetDirectoryName(new System.Diagnostics.StackFrame(true).GetFileName());
</code>
</pre>

    
</article>

<footer>
    <address class="author">Mat Roberts</address>
    <p><time datetime="2012-05-29">2012-05-29</time></p>
</footer>
<script src="scripts/prism.js"></script>
</body>
</html>